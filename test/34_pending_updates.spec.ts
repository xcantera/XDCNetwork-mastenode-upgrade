import { expect } from "chai";import { ethers } from "hardhat";import { setup } from "./00_fixture";
describe("T34 pending increments multiple epochs",()=>{it("sums rewards",async()=>{const ctx=await setup();const owner=ctx.users[0];await ctx.kyc.connect(ctx.kycVerifier).mint(await owner.getAddress(),"k");const stake=ethers.utils.parseEther("10000000");await ctx.validator.connect(owner).propose(await owner.getAddress(),{value: stake});const r1=ethers.utils.parseEther("5");const r2=ethers.utils.parseEther("8");await ctx.validator.connect(ctx.admin).allocateEpochReward(await owner.getAddress(),r1,{value:r1});await ctx.validator.connect(ctx.admin).allocateEpochReward(await owner.getAddress(),r2,{value:r2});expect(await ctx.vault.pending(await owner.getAddress())).to.equal(r1.add(r2));});});
